summary: BSD tar
git-url: https://github.com/libarchive/libarchive
web-url: https://www.libarchive.org/
src-url: https://www.libarchive.org/downloads/libarchive-3.8.2.tar.xz
src-sha: db0dee91561cbd957689036a3a71281efefd131d35d1d98ebbc32720e4da58e2
license: BSD-2-Clause
dep-pkg: liblz4 liblzo libzstd liblzma libbz2 libz libiconv libexpat openssl-dev
ldflags: -ldl

dopatch: |
    gsed -i '/CreatePkgConfigFile/d' CMakeLists.txt
    gsed -i 's|ENABLE_INSTALL|FALSE|' libarchive/CMakeLists.txt

install: |
    cmakew \
        -DENABLE_TEST=OFF \
        -DENABLE_ACL=ON \
        -DENABLE_XATTR=ON \
        -DENABLE_TAR=ON \
        -DENABLE_CAT=ON \
        -DENABLE_CPIO=ON \
        -DENABLE_UNZIP=ON \
        -DENABLE_TAR_SHARED=OFF \
        -DENABLE_CAT_SHARED=OFF \
        -DENABLE_CPIO_SHARED=OFF \
        -DENABLE_UNZIP_SHARED=OFF \
        -DENABLE_CNG=OFF \
        -DENABLE_LIBB2=OFF \
        -DENABLE_NETTLE=OFF \
        -DENABLE_MBEDTLS=OFF \
        -DENABLE_LIBXML2=OFF \
        -DENABLE_LZ4=ON \
        -DENABLE_LZO=ON \
        -DENABLE_ZLIB=ON \
        -DENABLE_LZMA=ON \
        -DENABLE_ZSTD=ON \
        -DENABLE_BZip2=ON \
        -DENABLE_ICONV=ON \
        -DENABLE_EXPAT=ON \
        -DENABLE_OPENSSL=ON \
        -DENABLE_INSTALL=ON \
        -DBUILD_SHARED_LIBS=OFF
