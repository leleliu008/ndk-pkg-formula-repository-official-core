summary: Protocol Buffers(data interchange format) compiler and library developed by Google
git-url: https://github.com/protocolbuffers/protobuf
git-sha: ee1355459c9ce7ffe264bc40cfdc7b7623d37e99
version: 24.3
license: BSD-3-Clause
dep-pkg: zlib jsoncpp abseil

# used by other package. make sure protoc and libprotoc have the same version
build0: |
    cmakew \
        -DCMAKE_CXX_STANDARD=17 \
        -Dprotobuf_WITH_ZLIB=ON \
        -Dprotobuf_BUILD_TESTS=OFF \
        -Dprotobuf_BUILD_EXAMPLES=OFF \
        -Dprotobuf_BUILD_LIBPROTOC=ON \
        -Dprotobuf_BUILD_SHARED_LIBS=OFF

dopatch: |
    sed_in_place 's|__NDK_MAJOR__|__ANDROID_API__|g' src/google/protobuf/port_def.inc
    sed_in_place 's|__NDK_MAJOR|__ANDROID_API__|g' src/google/protobuf/port_def.inc

install: |
    cmakew \
        -DCMAKE_CXX_STANDARD=17 \
        -Dprotobuf_WITH_ZLIB=ON \
        -Dprotobuf_BUILD_TESTS=OFF \
        -Dprotobuf_BUILD_EXAMPLES=OFF \
        -Dprotobuf_BUILD_PROTOC_BINARIES=OFF \
        -Dprotobuf_BUILD_LIBPROTOC=ON \
        -Dprotobuf_ABSL_PROVIDER=package \
        -Dprotobuf_JSONCPP_PROVIDER=package \
        -Dprotobuf_BUILD_SHARED_LIBS=OFF
    cmakew \
        -DCMAKE_CXX_STANDARD=17 \
        -Dprotobuf_WITH_ZLIB=ON \
        -Dprotobuf_BUILD_TESTS=OFF \
        -Dprotobuf_BUILD_EXAMPLES=OFF \
        -Dprotobuf_BUILD_PROTOC_BINARIES=OFF \
        -Dprotobuf_BUILD_LIBPROTOC=ON \
        -Dprotobuf_ABSL_PROVIDER=package \
        -Dprotobuf_JSONCPP_PROVIDER=package \
        -Dprotobuf_BUILD_SHARED_LIBS=ON
